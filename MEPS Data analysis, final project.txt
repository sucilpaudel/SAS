*==================================================================================;
*THIS PROGRAM USES THE DATA FROM THE Medical Expenditure Panel Survey (MEPS) available on
U.S. DEPARTMENT OF HEALTH AND HUMAN SERVICES Website.
THIS DATA IS ABOUT MEDICAL CONDITIONS FILE: HC-199.
*===================================================================================;
/*Below code is used to convert the SAS transport file to a permanent SAS dataset */

LIBNAME HOMEWORK '/folders/myfolders/FOODFILE';                                                              
     FILENAME IN1 '/folders/myfolders/h199.ssp';                                                
                                                                                                    
     PROC XCOPY IN=IN1 OUT=HOMEWORK IMPORT;                                                           
     RUN;  
*MAKING DATA INTO TEMPORARTY DATASET;

DATA TEST;
SET HOMEWORK.H199;
RUN;

*THE FOLLOWING PROCEDURE IS TO KNOW ALL LIST OF VARIABLES IN THE DATASET;
PROC CONTENTS DATA=TEST;   /*  112630 OBSERVATION AND 25 VARIABLES*/                                                     
TITLE 'LIST OF VARIABLES IN TEST SAS DATASET';                                      
 RUN;        

*SUMMARY STATISTICS OF THE WHOLE DATASET;

 PROC MEANS DATA=TEST MEAN MEDIAN  RANGE STD VAR QRANGE;
  RUN;
*THIS STEP IS TO GET PRELIMINARY INFORMATION OF THE FIRST 20 ROWS; 
                                                                                                    
 PROC PRINT DATA=TEST (OBS=20);                                                    
 TITLE 'FIRST 20 OBSERVATIONS IN TEST SAS DATASET';                                  
 RUN; 
*=====================================================================;
 *I AM INTERESTED TO SEE THE RELATIONSHIP BETWEEN INJURY AND EXPENSES;
 *RENAMING OF THE EXPENSE RELATED VARIABLE;
 *====================================================================;
DATA TEST1;
SET TEST;
EXPENSE=PERWT17F;
KEEP EXPENSE INJURY;
RUN;
*FREQUENCY TABLE OF THE INJURY VARIABLE;
PROC FREQ DATA=TEST1;
TABLE INJURY;
RUN;
*THE FOLLOWING UNIVARIATE PROCEDURE PROCEDUES THE HISTOGRAM;

TITLE 'SUMMARY OF EXPENSES VARIABLES';
 PROC UNIVARIATE DATA = TEST1 ;
HISTOGRAM EXPENSE / NORMAL; RUN;

*THIS STEP IS TO SORT DATA BY INJURY CATEGORY;
PROC SORT DATA=TEST1;
BY INJURY;
RUN;
* THE FOLLOWING IS THE SUMMARY STATISTICS OF EXPENSES VARIABLES GROUP BY INJURY;
PROC MEANS DATA = TEST1; VAR EXPENSE; BY INJURY;
RUN;

*TWO SAMPLE T-TEST;
*NULL HYPOTHESIS: MEAN EXPENDITURE FOR CONDITION DUE TO INJURY (INJURY=1) EQUALS TO MEAN 
EXPENDITURE FOR CONDITION WITHOUT INJURY (INJURY=2);
*ALTERNATE HYPOTHESIS: MEAN EXPENDITURE ARE DIFFERENT;
ODS GRAPHICS ON;
PROC TTEST DATA=TEST1;
     CLASS INJURY;
     VAR EXPENSE;
     RUN;
ODS GRAPHICS OFF;
*BASED ON T-TEST, WE FAIL TO REJECT NULL HYPOTHESIS. THIS IMPLIES THAT MEAN EXPENDITURE FOR 
CONDITION WITH INJURY AND WITHOUR INJURY ARE EQUAL;

*CREATION OF THE INJURY DUMMY VARIABLES;
DATA TEST2;
SET TEST1;
IF INJURY=1 THEN INJURY=0;
ELSE INJURY=1;
RUN;

PROC FREQ DATA=TEST2;
TABLE INJURY;
RUN;
*REGRESSION BETWEEN EXPENSES AND THE INJURY DUMMY VARIABLE;

ODS GRAPHICS ON;
TITLE 'LINEAR REGRESSION';
PROC REG DATA=TEST2;
  MODEL EXPENSE = INJURY;
RUN;
ODS GRAPHICS OFF;
*=========================================================================================;
* IN THE FOLLOWING CODE, I AM INTERESTED TO LOOK RELATIONSHIP OF EXPENSES WITH DISEASE CONDITION;
*=======================================================================================;
 DATA CHECK1;
 SET TEST;
 DISEASE=ICD10CDX;
RUN;

PROC FREQ DATA=CHECK1;
TABLE DISEASE;
RUN;
*BASED ON THE FREQUENCY TABLE I10 AND E78 HAS HIGHER PERCENTAGE;
*NOW I AM TAKING ONLY CONDITION OF I10 AND E78 TO SEE THE RELATIONSHIP WITH EXPENSES;

DATA CHECK2;
SET CHECK1;
EXPENSE=PERWT17F;
IF DISEASE IN ('I10','E78');
KEEP EXPENSE DISEASE ;
RUN;
*FREQUENCY TABLE OF DISEASE TAKING I10 AND E78;
PROC FREQ DATA=CHECK2;
TABLE DISEASE;
RUN;
*SORING OF THE DATA;
PROC SORT DATA=CHECK2;
BY DISEASE;
RUN;
*SUMMARY STATISTICS OF EXPENSE VARIABLE BY DISEASE CATEGORY;

PROC MEANS DATA = CHECK2; VAR EXPENSE; BY DISEASE;
RUN;

/*BASED ON FREQUENCY TABLE I10 AND E78 HAS HIGHER PERCENTAGE SO I WANT TO CHECK THEIR EXPENDITURE*/

/*NULL HYPOTHESIS: MEAN EXPENDITURE FOR I10 EQUALS TO MEAN EXPENDITURE FOR E78*/
/*ALTERNATE HYPOTHESIS: THERE IS DIFFERENCE*/
ODS GRAPHICS ON;
PROC TTEST DATA=CHECK2;
CLASS DISEASE;
VAR EXPENSE;
RUN;
ODS GRAPHICS OFF;
*/*BASED ON PULL T-TEST, WE REJECT NULL HYPOTHESIS.
 THERE IS DIFFERENCE IN MEAN EXPENDITURE FOR I10 AND E78 */
*===============================================================;
